{# File: show_profile.html #}
{# Author: Artemios Kayas (akayas@bu.edu) #}
{# Description: Show the profile of a user #}
{# Includes the profile image and the display name and displays them for each profile in the database #}
{% extends "mini_insta/base.html" %}

{% block content %}
<h1 style="text-align: center;"> {{profile.display_name}} </h1>
<div class="profile-container">
        <div class="profile">
            <h2>{{profile.display_name}}</h2>
            <p> {{profile.username}}</p>
            <p>{{profile.bio_text}}</p>
            <img src="{{profile.profile_image_url}}" alt="{{profile.display_name}}">
            <p><a href="{% url 'update_profile' profile.pk %}">Update Profile</a></p>
        </div>
        <div class="profile">
            <h2>Followers</h2>
            <p><a href="{% url 'show_followers' profile.pk %}">{{ profile.get_num_followers }} followers</a></p>
            <h2>Following</h2>
            <p><a href="{% url 'show_following' profile.pk %}">{{ profile.get_num_following }} following</a></p>
            <h2>Posts</h2>
            <p>TBD</p>
        </div>
        <div class ="profile">
            <h2>Posts from {{profile.display_name}}</h2>
            {% for post in profile.get_all_posts %}
                <p>{{ post.timestamp }}</p>
                {% with first_photo=post.get_all_photos.first %}
                    {% if first_photo %}
                        <img src="{{ first_photo.get_image_url }}" alt="{{ post.caption }}">
                    {% else %}
                        <img src="https://i.redd.it/mqc2fhzd0vcb1.jpg" alt="No image available">
                    {% endif %}
                {% endwith %}
                <h2><a href="{% url 'show_post' post.pk %}">{{ post.caption }}</a></h2>
                
            {% endfor %}
        </div>
</div>
{% endblock %}